{%- liquid

  assign section_name = 'product'
  assign section_classes = section_name
  assign section_id = section_name | append: '--' | append: section.id

  assign aos_id = section_id
  assign aos_delay = 250
  assign aos_delay_increment = 250

  assign section_background_colour = section.settings.background
  assign section_container = section.settings.container

  assign product_images = product.images | default: false
  assign product_modal_id = section_id | append: '--modal'
  assign product_shop_button_enabled = false
  assign product_tags = product.tags | default: false

  if product.has_only_default_variant and product.available
    assign product_shop_button_enabled = true
  endif

  if section.settings.anchor_id != blank
    assign section_id = section.settings.anchor_id
  endif

-%}

{%- style -%}

  {% if background_colour != blank %}
    #shopify-section-{{ section.id }} {
      background: rgba(var(--theme-colour-{{ background_colour }}), 1);
      {% case background_colour %}
        {% when 'orange' %}
          color: var(--theme-colour--black);
        {% when 'white' %}
          color: var(--theme-colour--black);
        {% else %}
          color: var(--theme-colour--white);
      {% endcase %}
    }
  {% endif %}

  .section-{{ section.id }}-padding {
    padding-top: calc({{ section.settings.padding_top }}px * 0.75);
    padding-bottom: calc({{ section.settings.padding_bottom }}px  * 0.75);
  }

  @media screen and (min-width: 992px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

{%- endstyle -%}

<div class="{{ section_classes }}" id="{{ section_id }}">
  {% render 'bs-container', state: 'open', container: container %}

    <div class='sticky-column'>
      <div class='sticky-column__container'>

        <div class='sticky-column__column sticky-column__column--scroll' data-column-width='two-thirds'>
          <div class='sticky-column__main'>
            <div class='sticky-column__content'>

              {% capture product_title_classes %}{{ section_name }}__title heading--primary heading--lg d-lg-none{% endcapture %}
              {% render 'product-title', classes: product_title_classes, element_tag: 'h1', product: product %}

              {% capture product_price_classes %}{{ section_name }}__price d-lg-none{% endcapture %}
              {% render 'product-price', classes: product_price_classes, product: product, show_symbol: true %}

              {% if product.images.size > 0 %}

                <div class='{{ section_name }}__images d-lg-none'>
                  {% render 'product-badge', product: product  %}
                  {% render 'product-image-gallery-modal-trigger', modal_id: product_modal_id %}
                  {% render 'product-image-gallery-carousel', carousel_bullets: true, modal_id: product_modal_id, product: product %}
                </div>

                <div class='{{ section_name }}__images d-none d-lg-block'>
                  {% render 'product-badge', product: product  %}
                  {% render 'product-image-gallery-grid', modal_id: product_modal_id, product: product %}
                </div>

              {% endif %}

            </div>
          </div>
        </div>

        <div class='sticky-column__column sticky-column__column--stuck' data-column-width='one-third'>
          <div class='sticky-column__main'>
            <div class='sticky-column__content'>

              {% capture product_title_classes %}{{ section_name }}__title heading--primary heading--lg d-none d-lg-block{% endcapture %}
              {% render 'product-title', classes: product_title_classes, element_tag: 'strong', product: product %}

              {% capture product_price_classes %}{{ section_name }}__price d-none d-lg-block{% endcapture %}
              {% render 'product-price', classes: product_price_classes, product: product, show_symbol: true %}

              {% render 'product-description', product: product %}

              <form class="{{ section_name }}__form-add-to-cart" action='/cart/add' method='post' enctype='multipart/form-data'>
                {% render 'product-options', product: product %}
                {% capture product_quantity_classes %}{{ section_name }}__quantity d-none{% endcapture %}
                {% render 'product-quantity', classes: product_quantity_classes, product: product %}
                {% render 'product-actions', product: product %}
              </form>

            </div>
          </div>
        </div>

      </div>
    </div>

  {% render 'bs-container', state: 'closed', container %}

  {% if product.images.size > 0 %}
    {% render 'product-image-gallery-modal', modal_id: product_modal_id, product: product %}
  {% endif %}

</div>

{% schema %}
{
	"name": "Main Product",
	"tag": "section",
	"class": "section section--main-product",
	"settings": [
    {
			"content": "Layout",
			"type": "header"
		},
		{
			"label": "Background",
			"type": "select",
			"options": [{
					"label": "Black",
					"value": "black"
				},
				{
					"label": "White",
					"value": "white"
				}
			],
			"default": "white",
			"id": "background"
		},
		{
			"label": "Container",
			"type": "select",
			"options": [{
					"label": "Static",
					"value": "container"
				},
				{
					"label": "Fluid",
					"value": "container-fluid"
				},
				{
					"label": "Full Width",
					"value": "full-width"
				}
			],
			"default": "container",
			"id": "container"
		},
    {
			"content": "Padding",
			"type": "header"
		},
		{
			"label": "Top Padding",
			"type": "range",
			"min": 0,
			"max": 120,
			"step": 4,
			"unit": "px",
			"default": 36,
      "id": "padding_top"
		},
		{
			"label": "Bottom Padding",
			"type": "range",
			"min": 0,
			"max": 120,
			"step": 4,
			"unit": "px",
			"default": 36,
      "id": "padding_bottom"
		}
	],
	"blocks": [
    {
		  "type": "@app"
	  }
  ]
}
{% endschema %}
